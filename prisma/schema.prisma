datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                    Int        @id @default(autoincrement())
  telegramId            String     @unique
  username              String?
  firstName             String?
  lastSeenAt            DateTime   @default(now())
  createdAt             DateTime   @default(now())
  games                 Game[]
  stars                 Int        @default(0) // –≤–∞–ª—é—Ç–∞ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞
  multiplierLevel       Int        @default(0) // —É—Ä–æ–≤–µ–Ω—å –º–Ω–æ–∂–∏—Ç–µ–ª—è
  extraTimeLevel        Int        @default(0) // —É—Ä–æ–≤–µ–Ω—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
  epicBoostLevel        Int        @default(0) // —à–∞–Ω—Å —ç–ø–∏–∫–æ–≤
  dailyCatch1000ClaimAt DateTime?
  dailyEpic100ClaimAt   DateTime?
  dailyPlay3ClaimAt     DateTime?
  referralsSent         Referral[] @relation("UserInviter")
  referralsReceived     Referral[] @relation("UserInvited")
  level                 Int        @default(1)
  xp                    Int        @default(0)
}

model Game {
  id         Int       @id @default(autoincrement())
  user       User      @relation(fields: [userId], references: [id])
  userId     Int
  score      Int?
  clicks     Int?      @default(0) // üëà —Å–∫–æ–ª—å–∫–æ –º–æ–Ω—Å—Ç—Ä–æ–≤ –ø–æ–π–º–∞–Ω–æ –∑–∞ –∏–≥—Ä—É
  epicCount  Int?      @default(0) // üëà —Å–∫–æ–ª—å–∫–æ —ç–ø–∏–∫–æ–≤
  createdAt  DateTime  @default(now())
  finishedAt DateTime?
}

model Referral {
  id        Int     @id @default(autoincrement())
  inviterId Int
  invitedId Int
  rewarded  Boolean @default(false)

  inviter User @relation("UserInviter", fields: [inviterId], references: [id])
  invited User @relation("UserInvited", fields: [invitedId], references: [id])

  createdAt DateTime @default(now())

  @@unique([inviterId, invitedId])
}
